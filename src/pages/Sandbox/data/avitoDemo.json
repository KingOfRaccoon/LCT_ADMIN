{
  "id": "avito-cart-demo",
  "name": "ÐÐ²Ð¸Ñ‚Ð¾ â€” ÐšÐ¾Ñ€Ð·Ð¸Ð½Ð°",
  "description": "ÐŸÑ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ ÑÑ†ÐµÐ½Ð°Ñ€Ð¸Ð¹ ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñ‹ Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¾Ð¹ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ð¸Ð· API",
  "slug": "avito-cart",
  "variableSchemas": {
    "cart_response": {
      "type": "object",
      "schema": {
        "id": "number",
        "user_id": "number",
        "shop_groups": "array",
        "total_amount": "number",
        "selected_items_count": "number",
        "total_items_count": "number"
      }
    },
    "store": {
      "type": "object",
      "schema": {
        "id": "number",
        "name": "string",
        "rating": "number"
      }
    },
    "ui": {
      "type": "object",
      "schema": {
        "ready": "boolean",
        "notifications": "object"
      }
    },
    "state": {
      "type": "object",
      "schema": {
        "empty": "boolean",
        "loading": "boolean"
      }
    },
    "selected_item_id": {
      "type": "number",
      "schema": null
    },
    "quantity": {
      "type": "number",
      "schema": null
    },
    "shop_id": {
      "type": "number",
      "schema": null
    },
    "advertisement_id": {
      "type": "number",
      "schema": null
    },
    "selected": {
      "type": "boolean",
      "schema": null
    },
    "liked": {
      "type": "boolean",
      "schema": null
    },
    "suggested_products": {
      "type": "array",
      "schema": []
    },
    "recommendations": {
      "type": "array",
      "schema": []
    },
    "removed_item": {
      "type": "object",
      "schema": {
        "id": "number",
        "quantity": "number",
        "advertisement": "object"
      }
    }
  },
  "initialContext": {
    "cart_response": {
      "id": 3,
      "user_id": 4,
      "shop_groups": [],
      "total_amount": 0,
      "selected_items_count": 0,
      "total_items_count": 0
    },
    "store": {
      "id": 14,
      "name": "Ð•ÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð° Ð‘Ð°Ñ‚ÑŽÑˆÐºÐ¾Ð²Ð°",
      "rating": 5.0
    },
    "selected_advertisement_id": 8,
    "add_to_cart_response": null,
    "selected_item_id": null,
    "quantity": 1,
    "shop_id": null,
    "advertisement_id": null,
    "selected": null,
    "liked": null,
    "suggested_products": [
      {
        "id": 10,
        "name": "Apple Watch 10 256Gb",
        "price": 26591,
        "image": "https://via.placeholder.com/80"
      },
      {
        "id": 11,
        "name": "iPhone 16 Pro 256Gb",
        "price": 99990,
        "image": "https://via.placeholder.com/80"
      }
    ],
    "recommendations": [],
    "removed_item": null,
    "ui": {
      "ready": false,
      "notifications": {
        "type": null,
        "message": null,
        "actionLabel": null,
        "actionEvent": null
      }
    },
    "state": {
      "empty": true,
      "loading": false
    }
  },
  "nodes": [
    {
      "id": "fetch-cart-items",
      "label": "Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñ‹",
      "type": "integration",
      "state_type": "integration",
      "start": true,
      "description": "Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÑ‚ ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñƒ Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð°Ð¼Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ",
      "expressions": [
        {
          "variable": "cart_response",
          "url": "https://sandkittens.me/backservices/api/carts/3/with-advertisements",
          "params": {},
          "method": "get",
          "metadata": {
            "description": "ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñƒ Ñ ID 3 Ð¸ Ð²ÑÐµ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ Ð² Ð½ÐµÐ¹",
            "category": "data",
            "tags": ["integration", "api", "cart", "advertisements"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "cart_response",
          "case": null,
          "state_id": "fetch-recommendations"
        }
      ],
      "edges": []
    },
    {
      "id": "fetch-recommendations",
      "label": "Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¹",
      "type": "integration",
      "state_type": "integration",
      "start": false,
      "description": "Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÑ‚ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ Ð´Ð»Ñ ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñ‹",
      "expressions": [
        {
          "variable": "recommendations",
          "url": "https://sandkittens.me/backservices/api/carts/3/recommendations?limit=10",
          "params": {},
          "method": "get",
          "metadata": {
            "description": "ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ ÑÐ¿Ð¸ÑÐ¾Ðº Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²",
            "category": "data",
            "tags": ["integration", "api", "recommendations"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "recommendations",
          "case": null,
          "state_id": "cart-main"
        }
      ],
      "edges": []
    },
    {
      "id": "cart-main",
      "label": "ÐšÐ¾Ñ€Ð·Ð¸Ð½Ð°",
      "type": "screen",
      "screenId": "screen-cart-main",
      "start": false,
      "edges": [
        {
          "id": "edge-add-to-cart",
          "label": "Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ‚Ð¾Ð²Ð°Ñ€",
          "event": "addToCart",
          "keepInputs": true,
          "summary": "Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñƒ",
          "target": "add-to-cart-integration",
          "contextPatch": {
            "advertisement_id": {
              "reference": "${eventParams.advertisement_id}",
              "value": null
            }
          }
        },
        {
          "id": "edge-increase-quantity",
          "label": "Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ñ‚ÑŒ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾",
          "event": "increaseQuantity",
          "keepInputs": true,
          "summary": "Ð£Ð²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ð°",
          "target": "increase-quantity-integration",
          "contextPatch": {
            "selected_item_id": {
              "reference": "${eventParams.selected_item_id}",
              "value": null
            },
            "quantity": {
              "reference": "${eventParams.quantity}",
              "value": null
            }
          }
        },
        {
          "id": "edge-decrease-quantity",
          "label": "Ð£Ð¼ÐµÐ½ÑŒÑˆÐ¸Ñ‚ÑŒ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾",
          "event": "decreaseQuantity",
          "keepInputs": true,
          "summary": "Ð£Ð¼ÐµÐ½ÑŒÑˆÐµÐ½Ð¸Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ð°",
          "target": "decrease-quantity-integration",
          "contextPatch": {
            "selected_item_id": {
              "reference": "${eventParams.selected_item_id}",
              "value": null
            },
            "quantity": {
              "reference": "${eventParams.quantity}",
              "value": null
            }
          }
        },
        {
          "id": "edge-remove-item",
          "label": "Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ‚Ð¾Ð²Ð°Ñ€",
          "event": "removeItem",
          "keepInputs": true,
          "summary": "Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð¸Ð· ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñ‹",
          "target": "prepare-remove-item",
          "contextPatch": {
            "selected_item_id": {
              "reference": "${eventParams.selected_item_id}",
              "value": null
            }
          }
        },
        {
          "id": "edge-undo-remove-item",
          "label": "ÐžÑ‚Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ",
          "event": "undoRemoveItem",
          "keepInputs": true,
          "summary": "Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚ ÑƒÐ´Ð°Ð»Ñ‘Ð½Ð½Ð¾Ð³Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñƒ",
          "target": "undo-remove-item-integration",
          "contextPatch": {}
        },
        {
          "id": "edge-toggle-focus",
          "label": "Ð¡Ð½ÑÑ‚ÑŒ/Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ñ„Ð¾ÐºÑƒÑ",
          "event": "toggleFocus",
          "keepInputs": true,
          "summary": "ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ ÑƒÑ‡Ð°ÑÑ‚Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð² Ñ€Ð°ÑÑ‡ÐµÑ‚Ðµ",
          "target": "toggle-focus-integration",
          "contextPatch": {
            "selected_item_id": {
              "reference": "${eventParams.selected_item_id}",
              "value": null
            },
            "selected": {
              "reference": "${eventParams.selected}",
              "value": null
            }
          }
        },
        {
          "id": "edge-toggle-liked",
          "label": "Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ/ÑƒÐ±Ñ€Ð°Ñ‚ÑŒ Ð¸Ð· Ð¸Ð·Ð±Ñ€Ð°Ð½Ð½Ð¾Ð³Ð¾",
          "event": "toggleLiked",
          "keepInputs": true,
          "summary": "ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° 'Ð¸Ð·Ð±Ñ€Ð°Ð½Ð½Ð¾Ðµ'",
          "target": "toggle-liked-integration",
          "contextPatch": {
            "selected_item_id": {
              "reference": "${eventParams.selected_item_id}",
              "value": null
            },
            "liked": {
              "reference": "${eventParams.liked}",
              "value": null
            }
          }
        },
        {
          "id": "edge-checkout",
          "label": "ÐžÑ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ Ð·Ð°ÐºÐ°Ð·",
          "event": "checkout",
          "keepInputs": true,
          "summary": "ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ Ðº Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸ÑŽ Ð·Ð°ÐºÐ°Ð·Ð°",
          "target": "checkout-screen",
          "contextPatch": {}
        },
        {
          "id": "edge-toggle-shop-selection",
          "label": "Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ/ÑÐ½ÑÑ‚ÑŒ Ð²Ñ‹Ð±Ð¾Ñ€ Ð¼Ð°Ð³Ð°Ð·Ð¸Ð½Ð°",
          "event": "toggleShopSelection",
          "keepInputs": true,
          "summary": "ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð²ÑÐµÑ… Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ð¼Ð°Ð³Ð°Ð·Ð¸Ð½Ð°",
          "target": "toggle-shop-selection-integration",
          "contextPatch": {
            "shop_id": {
              "reference": "${eventParams.shop_id}",
              "value": null
            }
          }
        },
        {
          "id": "edge-toggle-select-all",
          "label": "Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð²ÑÑ‘",
          "event": "toggleSelectAll",
          "keepInputs": true,
          "summary": "ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð²ÑÐµÑ… Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ðµ",
          "target": "toggle-select-all-integration",
          "contextPatch": {}
        },
        {
          "id": "edge-delete-selected",
          "label": "Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ðµ",
          "event": "deleteSelected",
          "keepInputs": true,
          "summary": "Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð²ÑÐµÑ… Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ñ… Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²",
          "target": "delete-selected-integration",
          "contextPatch": {}
        }
      ]
    },
    {
      "id": "add-to-cart-integration",
      "label": "Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñƒ",
      "type": "integration",
      "state_type": "integration",
      "start": false,
      "description": "POST-Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð´Ð»Ñ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñƒ",
      "expressions": [
        {
          "variable": "add_to_cart_response",
          "url": "https://sandkittens.me/backservices/api/carts/add-advertisement",
          "params": {},
          "method": "post",
          "body": {
            "cart_id": 3,
            "advertisement_id": "${advertisement_id}"
          },
          "metadata": {
            "description": "Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ Ñ‚Ð¾Ð²Ð°Ñ€ Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ",
            "category": "data",
            "tags": ["integration", "api", "cart", "post"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "add_to_cart_response",
          "case": null,
          "state_id": "fetch-cart-items"
        }
      ],
      "edges": []
    },
    {
      "id": "increase-quantity-integration",
      "label": "Ð£Ð²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð°",
      "type": "integration",
      "state_type": "integration",
      "start": false,
      "description": "PATCH-Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð´Ð»Ñ ÑƒÐ²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ñ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ðµ",
      "expressions": [
        {
          "variable": "add_to_cart_response",
          "url": "https://sandkittens.me/backservices/api/carts/3/items/${selected_item_id}",
          "params": {},
          "method": "patch",
          "body": {
            "quantity": "${quantity + 1}"
          },
          "metadata": {
            "description": "Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ð²Ð°ÐµÑ‚ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð½Ð° 1",
            "category": "data",
            "tags": ["integration", "api", "cart", "quantity"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "add_to_cart_response",
          "case": null,
          "state_id": "fetch-cart-items"
        }
      ],
      "edges": []
    },
    {
      "id": "decrease-quantity-integration",
      "label": "Ð£Ð¼ÐµÐ½ÑŒÑˆÐµÐ½Ð¸Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð°",
      "type": "integration",
      "state_type": "integration",
      "start": false,
      "description": "PATCH-Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð´Ð»Ñ ÑƒÐ¼ÐµÐ½ÑŒÑˆÐµÐ½Ð¸Ñ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ðµ",
      "expressions": [
        {
          "variable": "add_to_cart_response",
          "url": "https://sandkittens.me/backservices/api/carts/3/items/${selected_item_id}",
          "params": {},
          "method": "patch",
          "body": {
            "quantity": "${quantity - 1}"
          },
          "metadata": {
            "description": "Ð£Ð¼ÐµÐ½ÑŒÑˆÐ°ÐµÑ‚ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð½Ð° 1",
            "category": "data",
            "tags": ["integration", "api", "cart", "quantity"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "add_to_cart_response",
          "case": null,
          "state_id": "fetch-cart-items"
        }
      ],
      "edges": []
    },
    {
      "id": "prepare-remove-item",
      "label": "ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ðº ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸ÑŽ Ñ‚Ð¾Ð²Ð°Ñ€Ð°",
      "type": "technical",
      "state_type": "technical",
      "start": false,
      "description": "Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾Ð± ÑƒÐ´Ð°Ð»ÑÐµÐ¼Ð¾Ð¼ Ñ‚Ð¾Ð²Ð°Ñ€Ðµ Ð¸ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ snackbar",
      "expressions": [
        {
          "variable": "removed_item",
          "url": "",
          "params": {},
          "method": "expression",
          "body": "${cart_response.shop_groups.flatMap(shop => shop.items).find(item => item.id === selected_item_id)}",
          "metadata": {
            "description": "ÐÐ°Ñ…Ð¾Ð´Ð¸Ñ‚ Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ ID Ð¸ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑƒÐ´Ð°Ð»ÑÐµÐ¼Ð¾Ð³Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð°",
            "category": "data",
            "tags": ["cart", "delete", "state"]
          }
        },
        {
          "variable": "ui.notifications.message",
          "url": "",
          "params": {},
          "method": "expression",
          "body": "Ð¢Ð¾Ð²Ð°Ñ€ ÑƒÐ´Ð°Ð»Ñ‘Ð½ Ð¸Ð· ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñ‹",
          "metadata": {
            "description": "Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ Ñ‚ÐµÐºÑÑ‚ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ",
            "category": "ui",
            "tags": ["notification"]
          }
        },
        {
          "variable": "ui.notifications.actionLabel",
          "url": "",
          "params": {},
          "method": "expression",
          "body": "Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒ",
          "metadata": {
            "description": "Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ Ñ‚ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ",
            "category": "ui",
            "tags": ["notification"]
          }
        },
        {
          "variable": "ui.notifications.actionEvent",
          "url": "",
          "params": {},
          "method": "expression",
          "body": "undoRemoveItem",
          "metadata": {
            "description": "Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ",
            "category": "ui",
            "tags": ["notification"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "removed_item",
          "case": null,
          "state_id": "remove-item-integration"
        }
      ],
      "edges": []
    },
    {
      "id": "remove-item-integration",
      "label": "Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð°",
      "type": "integration",
      "state_type": "integration",
      "start": false,
      "description": "DELETE-Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð´Ð»Ñ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð¸Ð· ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñ‹",
      "expressions": [
        {
          "variable": "add_to_cart_response",
          "url": "https://sandkittens.me/backservices/api/carts/3/advertisements/${selected_item_id}",
          "params": {},
          "method": "delete",
          "metadata": {
            "description": "Ð£Ð´Ð°Ð»ÑÐµÑ‚ Ñ‚Ð¾Ð²Ð°Ñ€ Ð¸Ð· ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñ‹",
            "category": "data",
            "tags": ["integration", "api", "cart", "delete"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "add_to_cart_response",
          "case": null,
          "state_id": "fetch-cart-items"
        }
      ],
      "edges": []
    },
    {
      "id": "undo-remove-item-integration",
      "label": "ÐžÑ‚Ð¼ÐµÐ½Ð° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð°",
      "type": "integration",
      "state_type": "integration",
      "start": false,
      "description": "POST-Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð´Ð»Ñ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñƒ",
      "expressions": [
        {
          "variable": "add_to_cart_response",
          "url": "https://sandkittens.me/backservices/api/carts/3/items",
          "params": {},
          "method": "post",
          "body": {
            "advertisement_id": "${removed_item.advertisement.id}",
            "quantity": "${removed_item.quantity}"
          },
          "metadata": {
            "description": "Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ ÑƒÐ´Ð°Ð»Ñ‘Ð½Ð½Ñ‹Ð¹ Ñ‚Ð¾Ð²Ð°Ñ€ Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñƒ Ñ Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¼ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾Ð¼",
            "category": "data",
            "tags": ["integration", "api", "cart", "undo"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "add_to_cart_response",
          "case": null,
          "state_id": "clear-undo-state"
        }
      ],
      "edges": []
    },
    {
      "id": "clear-undo-state",
      "label": "ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð¾Ñ‚Ð¼ÐµÐ½Ñ‹",
      "type": "technical",
      "state_type": "technical",
      "start": false,
      "description": "ÐžÑ‡Ð¸Ñ‰Ð°ÐµÑ‚ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ snackbar Ð¸ removed_item Ð¿Ð¾ÑÐ»Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð°",
      "expressions": [
        {
          "variable": "ui.notifications.message",
          "expression": "null",
          "dependent_variables": [],
          "metadata": {
            "description": "Ð¡ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ",
            "category": "ui",
            "tags": ["notification"]
          }
        },
        {
          "variable": "ui.notifications.actionLabel",
          "expression": "null",
          "dependent_variables": [],
          "metadata": {
            "description": "ÐžÑ‡Ð¸Ñ‰Ð°ÐµÑ‚ Ñ‚ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ",
            "category": "ui",
            "tags": ["notification"]
          }
        },
        {
          "variable": "ui.notifications.actionEvent",
          "expression": "null",
          "dependent_variables": [],
          "metadata": {
            "description": "ÐžÑ‡Ð¸Ñ‰Ð°ÐµÑ‚ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ",
            "category": "ui",
            "tags": ["notification"]
          }
        },
        {
          "variable": "removed_item",
          "expression": "null",
          "dependent_variables": [],
          "metadata": {
            "description": "ÐžÑ‡Ð¸Ñ‰Ð°ÐµÑ‚ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾Ð± ÑƒÐ´Ð°Ð»Ñ‘Ð½Ð½Ð¾Ð¼ Ñ‚Ð¾Ð²Ð°Ñ€Ðµ",
            "category": "data",
            "tags": ["cart", "state"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "removed_item",
          "case": null,
          "state_id": "fetch-cart-items"
        }
      ],
      "edges": []
    },
    {
      "id": "toggle-focus-integration",
      "label": "ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ñ„Ð¾ÐºÑƒÑÐ°",
      "type": "integration",
      "state_type": "integration",
      "start": false,
      "description": "PATCH-Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð´Ð»Ñ ÑÐ½ÑÑ‚Ð¸Ñ/Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð° Ñ„Ð¾ÐºÑƒÑÐ° (ÑƒÑ‡Ð°ÑÑ‚Ð¸Ðµ Ð² Ñ€Ð°ÑÑ‡ÐµÑ‚Ðµ)",
      "expressions": [
        {
          "variable": "add_to_cart_response",
          "url": "https://sandkittens.me/backservices/api/carts/3/items/${selected_item_id}",
          "params": {},
          "method": "patch",
          "body": {
            "selected": "${!selected}"
          },
          "metadata": {
            "description": "ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ ÑƒÑ‡Ð°ÑÑ‚Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð² Ñ€Ð°ÑÑ‡ÐµÑ‚Ðµ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸",
            "category": "data",
            "tags": ["integration", "api", "cart", "focus"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "add_to_cart_response",
          "case": null,
          "state_id": "fetch-cart-items"
        }
      ],
      "edges": []
    },
    {
      "id": "toggle-liked-integration",
      "label": "ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð¸Ð·Ð±Ñ€Ð°Ð½Ð½Ð¾Ð³Ð¾",
      "type": "integration",
      "state_type": "integration",
      "start": false,
      "description": "PATCH-Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð´Ð»Ñ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ñ/ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð¸Ð· Ð¸Ð·Ð±Ñ€Ð°Ð½Ð½Ð¾Ð³Ð¾",
      "expressions": [
        {
          "variable": "add_to_cart_response",
          "url": "https://sandkittens.me/backservices/api/carts/3/items/${selected_item_id}",
          "params": {},
          "method": "patch",
          "body": {
            "liked": "${!liked}"
          },
          "metadata": {
            "description": "ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ ÑÑ‚Ð°Ñ‚ÑƒÑ Ð¸Ð·Ð±Ñ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð´Ð»Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð°",
            "category": "data",
            "tags": ["integration", "api", "cart", "liked", "favorite"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "add_to_cart_response",
          "case": null,
          "state_id": "fetch-cart-items"
        }
      ],
      "edges": []
    },
    {
      "id": "toggle-shop-selection-integration",
      "label": "ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð¼Ð°Ð³Ð°Ð·Ð¸Ð½Ð°",
      "type": "integration",
      "state_type": "integration",
      "start": false,
      "description": "PATCH-Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð²ÑÐµÑ… Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ð¼Ð°Ð³Ð°Ð·Ð¸Ð½Ð°",
      "expressions": [
        {
          "variable": "add_to_cart_response",
          "url": "https://sandkittens.me/backservices/api/carts/3/shops/${shop_id}/toggle-selection",
          "params": {},
          "method": "patch",
          "body": {},
          "metadata": {
            "description": "ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ Ð²Ñ‹Ð±Ð¾Ñ€ Ð²ÑÐµÑ… Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ð² Ð¼Ð°Ð³Ð°Ð·Ð¸Ð½Ðµ",
            "category": "data",
            "tags": ["integration", "api", "cart", "shop", "selection"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "add_to_cart_response",
          "case": null,
          "state_id": "fetch-cart-items"
        }
      ],
      "edges": []
    },
    {
      "id": "toggle-select-all-integration",
      "label": "Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ/ÑÐ½ÑÑ‚ÑŒ Ð²ÑÑ‘",
      "type": "integration",
      "state_type": "integration",
      "start": false,
      "description": "PATCH-Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð²ÑÐµÑ… Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ðµ",
      "expressions": [
        {
          "variable": "add_to_cart_response",
          "url": "https://sandkittens.me/backservices/api/carts/3/toggle-select-all",
          "params": {},
          "method": "patch",
          "body": {},
          "metadata": {
            "description": "ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ Ð²Ñ‹Ð±Ð¾Ñ€ Ð²ÑÐµÑ… Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ð² ÐºÐ¾Ñ€Ð·Ð¸Ð½Ðµ",
            "category": "data",
            "tags": ["integration", "api", "cart", "selection"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "add_to_cart_response",
          "case": null,
          "state_id": "fetch-cart-items"
        }
      ],
      "edges": []
    },
    {
      "id": "delete-selected-integration",
      "label": "Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ñ… Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²",
      "type": "integration",
      "state_type": "integration",
      "start": false,
      "description": "DELETE-Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð´Ð»Ñ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ð²ÑÐµÑ… Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ñ… Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²",
      "expressions": [
        {
          "variable": "add_to_cart_response",
          "url": "https://sandkittens.me/backservices/api/carts/3/selected-items",
          "params": {},
          "method": "delete",
          "metadata": {
            "description": "Ð£Ð´Ð°Ð»ÑÐµÑ‚ Ð²ÑÐµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ Ð¸Ð· ÐºÐ¾Ñ€Ð·Ð¸Ð½Ñ‹",
            "category": "data",
            "tags": ["integration", "api", "cart", "delete", "batch"]
          }
        }
      ],
      "transitions": [
        {
          "variable": "add_to_cart_response",
          "case": null,
          "state_id": "fetch-cart-items"
        }
      ],
      "edges": []
    },
    {
      "id": "checkout-screen",
      "label": "ÐžÑ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð·Ð°ÐºÐ°Ð·Ð°",
      "type": "screen",
      "screenId": "screen-checkout",
      "edges": []
    }
  ],
  "screens": {
    "screen-cart-main": {
      "id": "screen-cart-main",
      "type": "Screen",
      "name": "ÐšÐ¾Ñ€Ð·Ð¸Ð½Ð°",
      "style": {
        "display": "flex",
        "flexDirection": "column",
        "minHeight": "720px",
        "backgroundColor": "#ffffff",
        "borderRadius": "12px",
        "padding": "0px"
      },
      "sections": {
        "header": {
          "id": "section-cart-header",
          "type": "Section",
          "properties": {
            "slot": "header",
            "padding": 0,
            "spacing": 0,
            "background": "#ffffff"
          },
          "style": {
            "borderBottom": "none"
          },
          "children": [
            {
              "id": "row-navbar",
              "type": "row",
              "properties": {
                "spacing": 12,
                "alignItems": "center",
                "justifyContent": "space-between",
                "padding": 16
              },
              "style": {
                "height": "48px",
                "borderBottom": "1px solid #E5E5E5"
              },
              "children": [
                {
                  "id": "button-back",
                  "type": "button",
                  "properties": {
                    "text": "â†",
                    "variant": "link",
                    "event": "goBack"
                  },
                  "style": {
                    "fontSize": "24px",
                    "fontWeight": 400,
                    "color": "#0A74F0",
                    "background": "transparent",
                    "border": "none",
                    "cursor": "pointer",
                    "padding": "0",
                    "width": "40px",
                    "textAlign": "left"
                  }
                },
                {
                  "id": "text-cart-title",
                  "type": "text",
                  "properties": {
                    "content": "ÐšÐ¾Ñ€Ð·Ð¸Ð½Ð°",
                    "variant": "heading"
                  },
                  "style": {
                    "fontSize": "17px",
                    "fontWeight": 600,
                    "color": "#2F3034",
                    "flex": "1",
                    "textAlign": "center"
                  }
                },
                {
                  "id": "spacer-right",
                  "type": "text",
                  "properties": {
                    "content": "",
                    "variant": "body"
                  },
                  "style": {
                    "width": "40px"
                  }
                }
              ]
            },
            {
              "id": "row-cart-actions",
              "type": "row",
              "properties": {
                "spacing": 12,
                "alignItems": "center",
                "justifyContent": "space-between",
                "padding": 16
              },
              "style": {
                "height": "42px"
              },
              "children": [
                {
                  "id": "row-select-all",
                  "type": "row",
                  "properties": {
                    "spacing": 8,
                    "alignItems": "center"
                  },
                  "children": [
                    {
                      "id": "checkbox-select-all",
                      "type": "checkbox",
                      "properties": {
                        "checked": {
                          "reference": "${cart_response.selected_items_count === cart_response.total_items_count && cart_response.total_items_count > 0}",
                          "value": false
                        },
                        "event": "toggleSelectAll"
                      },
                      "style": {
                        "width": "20px",
                        "height": "20px"
                      }
                    },
                    {
                      "id": "text-select-all",
                      "type": "text",
                      "properties": {
                        "content": "Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð²ÑÑ‘",
                        "variant": "body"
                      },
                      "style": {
                        "fontSize": "15px",
                        "color": "#000000",
                        "fontWeight": 400
                      }
                    },
                    {
                      "id": "button-delete-selected",
                      "type": "button",
                      "properties": {
                        "text": {
                          "reference": "Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ (${cart_response.total_items_count})",
                          "value": "Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ (0)"
                        },
                        "variant": "link",
                        "event": "deleteSelected",
                        "disabled": {
                          "reference": "${cart_response.selected_items_count === 0}",
                          "value": true
                        }
                      },
                      "style": {
                        "fontSize": "15px",
                        "fontWeight": 400,
                        "color": "#0A74F0",
                        "background": "transparent",
                        "border": "none",
                        "cursor": "pointer",
                        "textDecoration": "none",
                        "padding": "0",
                        "marginLeft": "8px"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        "body": {
          "id": "section-cart-body",
          "type": "Section",
          "properties": {
            "slot": "body",
            "padding": 16,
            "spacing": 16,
            "alignItems": "stretch"
          },
          "style": {
            "flex": "1 1 auto",
            "overflowY": "auto"
          },
          "children": [
            {
              "id": "conditional-empty-state",
              "type": "conditional",
              "properties": {
                "condition": {
                  "reference": "${cart_response.shop_groups ? cart_response.shop_groups.length === 0 : true}",
                  "value": false
                }
              },
              "children": [
                {
                  "id": "column-empty-state",
                  "type": "column",
                  "properties": {
                    "spacing": 24,
                    "alignItems": "center",
                    "justifyContent": "center",
                    "padding": 64
                  },
                  "style": {
                    "flex": "1 1 auto"
                  },
                  "children": [
                    {
                      "id": "image-empty-cart",
                      "type": "image",
                      "properties": {
                        "src": "https://via.placeholder.com/200x200/E5E5E5/8E8E93?text=ðŸ›’",
                        "alt": "ÐŸÑƒÑÑ‚Ð°Ñ ÐºÐ¾Ñ€Ð·Ð¸Ð½Ð°"
                      },
                      "style": {
                        "width": "200px",
                        "height": "200px",
                        "borderRadius": "50%",
                        "objectFit": "cover"
                      }
                    },
                    {
                      "id": "text-empty-title",
                      "type": "text",
                      "properties": {
                        "content": "Ð’ ÐºÐ¾Ñ€Ð·Ð¸Ð½Ðµ Ð¿ÑƒÑÑ‚Ð¾",
                        "variant": "heading"
                      },
                      "style": {
                        "fontSize": "24px",
                        "fontWeight": 700,
                        "color": "#2F3034",
                        "textAlign": "center"
                      }
                    },
                    {
                      "id": "text-empty-description",
                      "type": "text",
                      "properties": {
                        "content": "Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ Ð¸Ð· ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³Ð°",
                        "variant": "body"
                      },
                      "style": {
                        "fontSize": "15px",
                        "fontWeight": 400,
                        "color": "#8E8E93",
                        "textAlign": "center"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "id": "conditional-cart-items",
              "type": "conditional",
              "properties": {
                "condition": {
                  "reference": "${cart_response.shop_groups ? cart_response.shop_groups.length > 0 : false}",
                  "value": true
                }
              },
              "children": [
                {
                  "id": "column-cart-content",
                  "type": "column",
                  "properties": {
                    "spacing": 16
                  },
                  "children": [
                    {
                      "id": "list-shop-groups",
                      "type": "list",
                      "properties": {
                        "dataSource": {
                          "reference": "${cart_response.shop_groups}",
                          "value": []
                        },
                        "itemAlias": "shop"
                      },
                      "style": {
                        "display": "flex",
                        "flexDirection": "column",
                        "gap": "24px"
                      },
                      "children": [
                        {
                          "id": "column-shop-group-{{itemIndex}}",
                          "type": "column",
                          "properties": {
                            "spacing": 12
                          },
                          "children": [
                            {
                              "id": "text-shop-name-{{itemIndex}}",
                              "type": "row",
                              "properties": {
                                "spacing": 8,
                                "alignItems": "center"
                              },
                              "style": {
                                "marginBottom": "8px"
                              },
                              "children": [
                                {
                                  "id": "checkbox-shop-{{itemIndex}}",
                                  "type": "checkbox",
                                  "properties": {
                                    "checked": {
                                      "reference": "${shop.selected}",
                                      "value": true
                                    },
                                    "event": "toggleShopSelection",
                                    "eventParams": {
                                      "shop_id": {
                                        "reference": "${shop.shop_id}",
                                        "value": 0
                                      }
                                    }
                                  },
                                  "style": {
                                    "width": "20px",
                                    "height": "20px"
                                  }
                                },
                                {
                                  "id": "text-shop-name-label-{{itemIndex}}",
                                  "type": "text",
                                  "properties": {
                                    "content": {
                                      "reference": "${shop.shop_name}",
                                      "value": "ÐœÐ°Ð³Ð°Ð·Ð¸Ð½"
                                    },
                                    "variant": "heading"
                                  },
                                  "style": {
                                    "fontSize": "17px",
                                    "fontWeight": 600,
                                    "color": "#2F3034"
                                  }
                                },
                                {
                                  "id": "text-shop-rating-{{itemIndex}}",
                                  "type": "text",
                                  "properties": {
                                    "content": {
                                      "reference": "${'â­ ' + shop.shop_rating + ' (' + 'shop.reviews_count' + ')'}",
                                      "value": "â­ 5.0 (0)"
                                    },
                                    "variant": "caption"
                                  },
                                  "style": {
                                    "fontSize": "13px",
                                    "fontWeight": 400,
                                    "color": "#8E8E93"
                                  }
                                }
                              ]
                            },
                            {
                              "id": "list-cart-items-{{itemIndex}}",
                              "type": "list",
                              "properties": {
                                "dataSource": {
                                  "reference": "${shop.items}",
                                  "value": []
                                },
                                "itemAlias": "product"
                              },
                              "style": {
                                "display": "flex",
                                "flexDirection": "column",
                                "gap": "12px"
                              },
                              "children": [
                        {
                          "id": "card-cart-item-{{itemIndex}}",
                          "type": "column",
                          "properties": {
                            "spacing": 12,
                            "padding": 16,
                            "background": "#ffffff"
                          },
                          "style": {
                            "borderRadius": "24px",
                            "border": "1px solid #E5E5E5",
                            "opacity": {
                              "reference": "${product.selected ? 1 : 0.5}",
                              "value": 1
                            }
                          },
                          "children": [
                            {
                              "id": "row-item-header-{{itemIndex}}",
                              "type": "row",
                              "properties": {
                                "spacing": 12,
                                "alignItems": "flex-start",
                                "justifyContent": "space-between"
                              },
                              "children": [
                                {
                                  "id": "row-item-info-{{itemIndex}}",
                                  "type": "row",
                                  "properties": {
                                    "spacing": 12,
                                    "flex": 1
                                  },
                                  "children": [
                                    {
                                      "id": "image-product-{{itemIndex}}",
                                      "type": "image",
                                      "properties": {
                                        "src": {
                                          "reference": "${product.image || 'https://via.placeholder.com/80'}",
                                          "value": "https://via.placeholder.com/80"
                                        },
                                        "alt": "Ð¤Ð¾Ñ‚Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð°"
                                      },
                                      "style": {
                                        "width": "80px",
                                        "height": "80px",
                                        "borderRadius": "8px",
                                        "objectFit": "cover"
                                      }
                                    },
                                    {
                                      "id": "column-item-details-{{itemIndex}}",
                                      "type": "column",
                                      "properties": {
                                        "spacing": 6,
                                        "flex": 1
                                      },
                                      "children": [
                                        {
                                          "id": "text-item-title-{{itemIndex}}",
                                          "type": "text",
                                          "properties": {
                                            "content": {
                                              "reference": "${product.name}",
                                              "value": "ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð°"
                                            },
                                            "variant": "body"
                                          },
                                          "style": {
                                            "fontSize": "15px",
                                            "fontWeight": 600,
                                            "color": "#000000"
                                          }
                                        },
                                        {
                                          "id": "text-item-description-{{itemIndex}}",
                                          "type": "text",
                                          "properties": {
                                            "content": {
                                              "reference": "${product.description}",
                                              "value": "ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð°"
                                            },
                                            "variant": "caption"
                                          },
                                          "style": {
                                            "fontSize": "13px",
                                            "fontWeight": 400,
                                            "color": "#8E8E93"
                                          }
                                        },
                                        {
                                          "id": "row-price-info-{{itemIndex}}",
                                          "type": "row",
                                          "properties": {
                                            "spacing": 8,
                                            "alignItems": "center"
                                          },
                                          "children": [
                                            {
                                              "id": "text-item-price-{{itemIndex}}",
                                              "type": "text",
                                              "properties": {
                                                "content": {
                                                  "reference": "${product.price * product.quantity} â‚½",
                                                  "value": "0 â‚½"
                                                },
                                                "variant": "body"
                                              },
                                              "style": {
                                                "fontSize": "17px",
                                                "fontWeight": 700,
                                                "color": "#000000"
                                              }
                                            },
                                            {
                                              "id": "conditional-old-price-{{itemIndex}}",
                                              "type": "conditional",
                                              "properties": {
                                                "condition": {
                                                  "reference": "${product.original_price && product.original_price > product.price}",
                                                  "value": false
                                                }
                                              },
                                              "children": [
                                                {
                                                  "id": "text-item-old-price-{{itemIndex}}",
                                                  "type": "text",
                                                  "properties": {
                                                    "content": {
                                                      "reference": "${product.original_price} â‚½",
                                                      "value": "0 â‚½"
                                                    },
                                                    "variant": "caption"
                                                  },
                                                  "style": {
                                                    "fontSize": "13px",
                                                    "fontWeight": 400,
                                                    "color": "#8E8E93",
                                                    "textDecoration": "line-through"
                                                  }
                                                }
                                              ]
                                            },
                                            {
                                              "id": "conditional-discount-badge-{{itemIndex}}",
                                              "type": "conditional",
                                              "properties": {
                                                "condition": {
                                                  "reference": "${product.discount_percent && product.discount_percent > 0}",
                                                  "value": false
                                                }
                                              },
                                              "children": [
                                                {
                                                  "id": "badge-discount-{{itemIndex}}",
                                                  "type": "text",
                                                  "properties": {
                                                    "content": {
                                                      "reference": "-${product.discount_percent}%",
                                                      "value": "-5%"
                                                    },
                                                    "variant": "caption"
                                                  },
                                                  "style": {
                                                    "fontSize": "11px",
                                                    "fontWeight": 600,
                                                    "color": "#FF3B30",
                                                    "backgroundColor": "#FFEBE9",
                                                    "padding": "2px 6px",
                                                    "borderRadius": "4px"
                                                  }
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "id": "column-item-actions-{{itemIndex}}",
                                  "type": "column",
                                  "properties": {
                                    "spacing": 8,
                                    "alignItems": "flex-end"
                                  },
                                  "children": [
                                    {
                                      "id": "button-toggle-liked-{{itemIndex}}",
                                      "type": "button",
                                      "properties": {
                                        "text": {
                                          "reference": "${product.liked ? 'â¤ï¸' : 'ðŸ¤'}",
                                          "value": "ðŸ¤"
                                        },
                                        "variant": "ghost",
                                        "event": "toggleLiked",
                                        "eventParams": {
                                          "selected_item_id": {
                                            "reference": "${product.advertisement_id}",
                                            "value": 0
                                          },
                                          "liked": {
                                            "reference": "${product.liked}",
                                            "value": false
                                          }
                                        }
                                      },
                                      "style": {
                                        "padding": "8px",
                                        "fontSize": "18px",
                                        "background": "transparent",
                                        "border": "none",
                                        "cursor": "pointer"
                                      }
                                    },
                                    {
                                      "id": "button-remove-{{itemIndex}}",
                                      "type": "button",
                                      "properties": {
                                        "text": "ðŸ—‘ï¸",
                                        "variant": "ghost",
                                        "event": "removeItem",
                                        "eventParams": {
                                          "selected_item_id": {
                                            "reference": "${product.advertisement_id}",
                                            "value": 0
                                          }
                                        }
                                      },
                                      "style": {
                                        "padding": "8px",
                                        "fontSize": "18px",
                                        "background": "transparent",
                                        "border": "none",
                                        "cursor": "pointer"
                                      }
                                    },
                                    {
                                      "id": "button-toggle-focus-{{itemIndex}}",
                                      "type": "button",
                                      "properties": {
                                        "text": {
                                          "reference": "${product.selected ? 'â˜‘ï¸' : 'â¬œ'}",
                                          "value": "â˜‘ï¸"
                                        },
                                        "variant": "ghost",
                                        "event": "toggleFocus",
                                        "eventParams": {
                                          "selected_item_id": {
                                            "reference": "${product.advertisement_id}",
                                            "value": 0
                                          },
                                          "selected": {
                                            "reference": "${product.selected}",
                                            "value": false
                                          }
                                        }
                                      },
                                      "style": {
                                        "padding": "8px",
                                        "fontSize": "18px",
                                        "background": "transparent",
                                        "border": "none",
                                        "cursor": "pointer"
                                      }
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "id": "row-item-quantity-{{itemIndex}}",
                              "type": "row",
                              "properties": {
                                "spacing": 12,
                                "alignItems": "center",
                                "justifyContent": "space-between"
                              },
                              "children": [
                                {
                                  "id": "button-buy-with-delivery-{{itemIndex}}",
                                  "type": "button",
                                  "properties": {
                                    "text": "ÐšÑƒÐ¿Ð¸Ñ‚ÑŒ Ñ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¾Ð¹",
                                    "variant": "link",
                                    "event": "buyWithDelivery",
                                    "eventParams": {
                                      "product_id": {
                                        "reference": "${product.advertisement_id}",
                                        "value": 0
                                      }
                                    }
                                  },
                                  "style": {
                                    "fontSize": "14px",
                                    "fontWeight": 400,
                                    "color": "#8B5CF6",
                                    "background": "transparent",
                                    "border": "none",
                                    "cursor": "pointer",
                                    "textDecoration": "none",
                                    "padding": "0"
                                  }
                                },
                                {
                                  "id": "row-quantity-controls-{{itemIndex}}",
                                  "type": "row",
                                  "properties": {
                                    "spacing": 8,
                                    "alignItems": "center"
                                  },
                                  "children": [
                                    {
                                      "id": "button-decrease-{{itemIndex}}",
                                      "type": "button",
                                      "properties": {
                                        "text": "âˆ’",
                                        "variant": "secondary",
                                        "event": "decreaseQuantity",
                                        "eventParams": {
                                          "selected_item_id": {
                                            "reference": "${product.advertisement_id}",
                                            "value": 0
                                          },
                                          "quantity": {
                                            "reference": "${product.quantity}",
                                            "value": 1
                                          }
                                        },
                                        "disabled": {
                                          "reference": "${product.quantity <= 1}",
                                          "value": false
                                        }
                                      },
                                      "style": {
                                        "width": "32px",
                                        "height": "32px",
                                        "padding": "0",
                                        "borderRadius": "8px",
                                        "backgroundColor": "#F0F0F0",
                                        "fontSize": "18px",
                                        "fontWeight": 600,
                                        "color": "#000000",
                                        "border": "1px solid #E5E5E5",
                                        "cursor": "pointer"
                                      }
                                    },
                                    {
                                      "id": "text-quantity-{{itemIndex}}",
                                      "type": "text",
                                      "properties": {
                                        "content": {
                                          "reference": "${product.quantity}",
                                          "value": "-1"
                                        },
                                        "variant": "body"
                                      },
                                      "style": {
                                        "fontSize": "15px",
                                        "fontWeight": 600,
                                        "color": "#000000",
                                        "minWidth": "24px",
                                        "textAlign": "center"
                                      }
                                    },
                                    {
                                      "id": "button-increase-{{itemIndex}}",
                                      "type": "button",
                                      "properties": {
                                        "text": "+",
                                        "variant": "secondary",
                                        "event": "increaseQuantity",
                                        "eventParams": {
                                          "selected_item_id": {
                                            "reference": "${product.advertisement_id}",
                                            "value": 0
                                          },
                                          "quantity": {
                                            "reference": "${product.quantity}",
                                            "value": 1
                                          }
                                        }
                                      },
                                      "style": {
                                        "width": "32px",
                                        "height": "32px",
                                        "padding": "0",
                                        "borderRadius": "8px",
                                        "backgroundColor": "#F0F0F0",
                                        "fontSize": "18px",
                                        "fontWeight": 600,
                                        "color": "#000000",
                                        "border": "1px solid #E5E5E5",
                                        "cursor": "pointer"
                                      }
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "id": "column-suggested-section",
                      "type": "column",
                      "properties": {
                        "spacing": 12,
                        "padding": 16,
                        "background": "#F9F9F9"
                      },
                      "style": {
                        "borderRadius": "16px",
                        "marginTop": "16px"
                      },
                      "children": [
                        {
                          "id": "text-suggested-title",
                          "type": "text",
                          "properties": {
                            "content": "Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ ÐµÑ‰Ñ‘ 1 Ñ‚Ð¾Ð²Ð°Ñ€ Ð´Ð¾ ÑÐºÐ¸Ð´ÐºÐ¸ 5%",
                            "variant": "body"
                          },
                          "style": {
                            "fontSize": "15px",
                            "fontWeight": 600,
                            "color": "#2F3034",
                            "marginBottom": "8px"
                          }
                        },
                        {
                          "id": "list-suggested-products",
                          "type": "list",
                          "properties": {
                            "dataSource": {
                              "reference": "${recommendations}",
                              "value": []
                            },
                            "itemAlias": "suggested"
                          },
                          "style": {
                            "display": "flex",
                            "flexDirection": "row",
                            "gap": "12px",
                            "overflowX": "auto",
                            "overflowY": "hidden",
                            "paddingBottom": "8px"
                          },
                          "children": [
                        {
                          "id": "card-suggested-{{itemIndex}}",
                          "type": "card",
                          "properties": {
                            "event": "addToCart",
                            "eventParams": {
                              "advertisement_id": {
                                "reference": "${suggested.id}",
                                "value": 0
                              }
                            }
                          },
                          "style": {
                            "borderRadius": "12px",
                            "border": "1px solid #E5E5E5",
                            "cursor": "pointer",
                            "minWidth": "160px",
                            "maxWidth": "160px",
                            "flexShrink": 0,
                            "transition": "box-shadow 0.2s, transform 0.2s",
                            "background": "#ffffff"
                          },
                          "children": [
                            {
                              "id": "column-suggested-content-{{itemIndex}}",
                              "type": "column",
                              "properties": {
                                "spacing": 8,
                                "padding": 12
                              },
                              "children": [
                                {
                                  "id": "image-suggested-{{itemIndex}}",
                                  "type": "image",
                                  "properties": {
                                    "src": {
                                      "reference": "${suggested.image ? suggested.image : 'https://via.placeholder.com/136x136'}",
                                      "value": "https://via.placeholder.com/136x136"
                                    },
                                    "alt": "ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÐµÐ¼Ñ‹Ð¹ Ñ‚Ð¾Ð²Ð°Ñ€"
                                  },
                                  "style": {
                                    "width": "100%",
                                    "height": "136px",
                                    "borderRadius": "8px",
                                    "objectFit": "cover",
                                    "marginBottom": "4px"
                                  }
                                },
                                {
                                  "id": "column-suggested-info-{{itemIndex}}",
                                  "type": "column",
                                  "properties": {
                                    "spacing": 4,
                                    "flex": 1
                                  },
                                  "children": [
                                    {
                                      "id": "text-suggested-price-{{itemIndex}}",
                                      "type": "text",
                                      "properties": {
                                        "content": {
                                          "reference": "${suggested.price + ' â‚½'}",
                                          "value": "0 â‚½"
                                        },
                                        "variant": "body"
                                      },
                                      "style": {
                                        "fontSize": "16px",
                                        "fontWeight": 700,
                                        "color": "#000000",
                                        "marginBottom": "4px"
                                      }
                                    },
                                    {
                                      "id": "text-suggested-name-{{itemIndex}}",
                                      "type": "text",
                                      "properties": {
                                        "content": {
                                          "reference": "${suggested.name}",
                                          "value": "Ð¢Ð¾Ð²Ð°Ñ€"
                                        },
                                        "variant": "body"
                                      },
                                      "style": {
                                        "fontSize": "13px",
                                        "fontWeight": 500,
                                        "color": "#000000",
                                        "overflow": "hidden",
                                        "textOverflow": "ellipsis",
                                        "display": "-webkit-box",
                                        "WebkitLineClamp": "2",
                                        "WebkitBoxOrient": "vertical",
                                        "lineHeight": "1.3",
                                        "marginBottom": "4px"
                                      }
                                    },
                                    {
                                      "id": "text-suggested-owner-{{itemIndex}}",
                                      "type": "text",
                                      "properties": {
                                        "content": {
                                          "reference": "${suggested.owner_name}",
                                          "value": "ÐŸÑ€Ð¾Ð´Ð°Ð²ÐµÑ†"
                                        },
                                        "variant": "caption"
                                      },
                                      "style": {
                                        "fontSize": "11px",
                                        "fontWeight": 400,
                                        "color": "#8E8E93"
                                      }
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "snackbar": {
      "id": "section-cart-snackbar",
      "type": "Section",
      "properties": {
        "slot": "snackbar",
        "padding": 0,
        "spacing": 0
      },
      "style": {
        "position": "relative",
        "zIndex": 1000
      },
      "children": [
        {
          "id": "conditional-snackbar",
          "type": "conditional",
          "properties": {
            "condition": {
              "reference": "${ui.notifications.message !== null}",
              "value": false
            }
          },
          "children": [
            {
              "id": "snackbar-notification",
              "type": "row",
              "properties": {
                "spacing": 12,
                "alignItems": "center",
                "justifyContent": "space-between",
                "padding": 16
              },
              "style": {
                "position": "absolute",
                "bottom": "16px",
                "left": "16px",
                "right": "16px",
                "backgroundColor": "#2F3034",
                "borderRadius": "12px",
                "boxShadow": "0 4px 12px rgba(0, 0, 0, 0.15)",
                "zIndex": 1000
              },
              "children": [
                {
                  "id": "text-snackbar-message",
                  "type": "text",
                  "properties": {
                    "content": {
                      "reference": "${ui.notifications.message}",
                      "value": "Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ"
                    },
                    "variant": "body"
                  },
                  "style": {
                    "fontSize": "15px",
                    "fontWeight": 400,
                    "color": "#ffffff",
                    "flex": 1
                  }
                },
                {
                  "id": "conditional-snackbar-action",
                  "type": "conditional",
                  "properties": {
                    "condition": {
                      "reference": "${ui.notifications.actionLabel !== null}",
                      "value": false
                    }
                  },
                  "children": [
                    {
                      "id": "button-snackbar-action",
                      "type": "button",
                      "properties": {
                        "text": {
                          "reference": "${ui.notifications.actionLabel}",
                          "value": "Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ"
                        },
                        "variant": "link",
                        "event": {
                          "reference": "${ui.notifications.actionEvent}",
                          "value": "snackbarAction"
                        }
                      },
                      "style": {
                        "fontSize": "15px",
                        "fontWeight": 600,
                        "color": "#8B5CF6",
                        "background": "transparent",
                        "border": "none",
                        "cursor": "pointer",
                        "padding": "0"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "footer": {
          "id": "section-cart-footer",
          "type": "Section",
          "properties": {
            "slot": "footer",
            "padding": 16,
            "spacing": 0,
            "background": "#ffffff"
          },
          "style": {
            "borderTop": "1px solid #E5E5E5",
            "boxShadow": "0 -4px 24px rgba(0, 0, 0, 0.12), 0 -1px 3px rgba(0, 0, 0, 0.05)"
          },
          "children": [
            {
              "id": "row-footer-content",
              "type": "row",
              "properties": {
                "spacing": 16,
                "alignItems": "center",
                "justifyContent": "space-between"
              },
              "style": {
                "height": "52px"
              },
              "children": [
                {
                  "id": "column-total-details",
                  "type": "column",
                  "properties": {
                    "spacing": 4
                  },
                  "style": {
                    "flex": "1"
                  },
                  "children": [
                    {
                      "id": "text-total-label",
                      "type": "text",
                      "properties": {
                        "content": {
                          "reference": "${cart_response.selected_items_count} ${cart_response.selected_items_count === 1 ? 'Ñ‚Ð¾Ð²Ð°Ñ€' : (cart_response.selected_items_count >= 2 && cart_response.selected_items_count <= 4 ? 'Ñ‚Ð¾Ð²Ð°Ñ€Ð°' : 'Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²')}",
                          "value": "0 Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²"
                        },
                        "variant": "body"
                      },
                      "style": {
                        "fontSize": "13px",
                        "fontWeight": 400,
                        "color": "#8E8E93"
                      }
                    },
                    {
                      "id": "text-total-price",
                      "type": "text",
                      "properties": {
                        "content": {
                          "reference": "${(cart_response.total_amount ? cart_response.total_amount : 0) + ' â‚½'}",
                          "value": "0 â‚½"
                        },
                        "variant": "heading"
                      },
                      "style": {
                        "fontSize": "20px",
                        "fontWeight": 700,
                        "color": "#000000"
                      }
                    }
                  ]
                },
                {
                  "id": "button-checkout",
                  "type": "button",
                  "properties": {
                    "text": "ÐžÑ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ",
                    "variant": "primary",
                    "event": "checkout",
                    "disabled": {
                      "reference": "${cart_response.total_items_count === 0}",
                      "value": true
                    }
                  },
                  "style": {
                    "minWidth": "182px",
                    "padding": "16px 24px",
                    "borderRadius": "16px",
                    "backgroundColor": "#8B5CF6",
                    "fontSize": "16px",
                    "fontWeight": 600,
                    "color": "#ffffff",
                    "border": "none",
                    "cursor": "pointer",
                    "transition": "background-color 0.2s"
                  }
                }
              ]
            }
          ]
        }
      }
    },
    "screen-checkout": {
      "id": "screen-checkout",
      "type": "Screen",
      "name": "ÐžÑ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ",
      "style": {
        "display": "flex",
        "flexDirection": "column",
        "minHeight": "720px",
        "backgroundColor": "#ffffff",
        "borderRadius": "12px",
        "padding": "0px"
      },
      "sections": {
        "body": {
          "id": "section-checkout-body",
          "type": "Section",
          "properties": {
            "slot": "body",
            "padding": 32,
            "spacing": 16,
            "alignItems": "stretch"
          },
          "style": {
            "flex": "1 1 auto"
          },
          "children": [
            {
              "id": "text-checkout-title",
              "type": "text",
              "properties": {
                "content": "ÐžÑ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð·Ð°ÐºÐ°Ð·Ð°",
                "variant": "heading"
              },
              "style": {
                "fontSize": "24px",
                "fontWeight": 700,
                "color": "#2F3034"
              }
            },
            {
              "id": "text-checkout-placeholder",
              "type": "text",
              "properties": {
                "content": "Ð¤Ð¾Ñ€Ð¼Ð° Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¿Ð¾ÑÐ²Ð¸Ñ‚ÑÑ Ð·Ð´ÐµÑÑŒ",
                "variant": "body"
              },
              "style": {
                "fontSize": "15px",
                "color": "#8E8E93"
              }
            }
          ]
        }
      }
    }
  }
}
