# Рефакторинг кнопки "Добавить в корзину"

## Дата: 17 октября 2025

## Описание изменений

Кнопка "Добавить в корзину" вынесена из карточек товаров и размещена под списком с фиксированными значениями.

## Изменения

### 1. Удалена кнопка из карточек товаров

**Было:** Каждая карточка товара содержала кнопку с динамическим `advertisement_id`
```json
{
  "id": "button-add-to-cart-{{itemIndex}}",
  "eventParams": {
    "advertisement_id": "${product.id}"
  }
}
```

**Стало:** Карточки товаров содержат только информацию (название, описание, продавец)

### 2. Добавлена глобальная кнопка под списком

Новая кнопка размещена в секции `body` после списка товаров:

```json
{
  "id": "button-add-to-cart",
  "type": "button",
  "properties": {
    "text": "Добавить товар в корзину",
    "variant": "secondary",
    "event": "addToCart",
    "eventParams": {
      "advertisement_id": 8
    }
  },
  "style": {
    "marginTop": "16px",
    "padding": "12px 24px",
    "borderRadius": "12px",
    "backgroundColor": "#F0F0F0",
    "fontSize": "15px",
    "fontWeight": 600,
    "color": "#0A74F0",
    "border": "1px solid #E5E5E5",
    "cursor": "pointer"
  }
}
```

### 3. Фиксированные значения

**Текущие параметры (hardcoded):**
- `cart_id`: 3 (из `cart.id`)
- `advertisement_id`: 8 (фиксированное значение)

**Для будущего:** Значения подготовлены для динамической подстановки:
- `advertisement_id` можно будет изменять через UI или получать из выбранного товара
- Уже используется `${cart.id}` в интеграционном узле для `cart_id`

## Визуальное расположение

```
┌─────────────────────────────────────┐
│ Header: Корзина                     │
│ Магазин: Екатерина Батюшкова        │
├─────────────────────────────────────┤
│ Body:                               │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ Товар 1: Зарядка MagSafe        │ │
│ │ Описание...                     │ │
│ │ Продавец: Екатерина Батюшкова   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ Товар 2: AirPods Pro 2          │ │
│ │ Описание...                     │ │
│ │ Продавец: Екатерина Батюшкова   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ [Добавить товар в корзину]  ← NEW  │
│                                     │
├─────────────────────────────────────┤
│ Footer:                             │
│ [Перейти к оформлению]              │
└─────────────────────────────────────┘
```

## Стилизация кнопки

Кнопка использует secondary стиль:
- Фон: светло-серый (#F0F0F0)
- Цвет текста: синий (#0A74F0)
- Граница: светло-серая (#E5E5E5)
- Отступ сверху: 16px
- Размер шрифта: 15px

## Флоу работы (без изменений)

```
[Корзина] 
   ↓ (клик "Добавить товар в корзину")
[add-to-cart-integration] 
   POST: cart_id=3, advertisement_id=8
   ↓ (успех)
[refresh-cart-items] 
   GET: обновленный список товаров
   ↓
[Корзина] (возврат с обновленными данными)
```

## Планируемые улучшения

### Фаза 1 (текущая)
- ✅ Фиксированные значения `cart_id=3`, `advertisement_id=8`
- ✅ Одна кнопка для всего списка

### Фаза 2 (будущее)
- [ ] Добавить выбор товара (radio buttons или dropdown)
- [ ] Динамическое получение `advertisement_id` из выбранного товара
- [ ] Добавить валидацию (проверка выбора товара)
- [ ] Показывать текущий выбранный товар

### Фаза 3 (расширение)
- [ ] Множественный выбор товаров (checkboxes)
- [ ] Массовое добавление в корзину
- [ ] Количество товаров для добавления

## API (без изменений)

**POST** `https://sandkittens.me/backservices/api/carts/add-advertisement`
```json
{
  "cart_id": 3,
  "advertisement_id": 8
}
```

## Тестирование

1. Откройте http://localhost:5173/sandbox
2. Должен загрузиться список товаров
3. Под списком товаров отображается кнопка "Добавить товар в корзину"
4. При клике выполняется POST с `advertisement_id=8`
5. Список товаров обновляется

## Примечания

- Кнопка всегда видна и доступна
- Не зависит от состояния списка товаров
- Готова к расширению для динамических значений
- Использует простую secondary стилизацию для отличия от primary кнопки оформления заказа
