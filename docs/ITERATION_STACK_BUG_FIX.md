# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –±–∞–≥–∞ —Å iterationStack

## –î–∞—Ç–∞: 18 –æ–∫—Ç—è–±—Ä—è 2025 –≥.

## üêõ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è Phase 2 (–º–µ–º–æ–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤) –∏ Phase 1 (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–æ–≤) –±—ã–ª –æ–±–Ω–∞—Ä—É–∂–µ–Ω –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥:

**–°–∏–º–ø—Ç–æ–º—ã:**
- –°–ø–∏—Å–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏ placeholder-–∑–Ω–∞—á–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `${product.name}` –≤–æ–∑–≤—Ä–∞—â–∞–ª "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" (fallback)
- `${product.description}` –≤–æ–∑–≤—Ä–∞—â–∞–ª "–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" (fallback)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –±—ã–ª–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º (4 —ç–ª–µ–º–µ–Ω—Ç–∞), –Ω–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–¥—Ç—è–≥–∏–≤–∞–ª–∏—Å—å

**–ü—Ä–∏–º–µ—Ä:**
```
–¢–æ–≤–∞—Ä #1: –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
–¢–æ–≤–∞—Ä #2: –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
–¢–æ–≤–∞—Ä #3: –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
–¢–æ–≤–∞—Ä #4: –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
```

–í–º–µ—Å—Ç–æ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ:
```
–¢–æ–≤–∞—Ä #1: –ö–ª–∞—Å—Å–Ω—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏
–¢–æ–≤–∞—Ä #2: –¢–µ–ª–µ—Ñ–æ–Ω Samsung
–¢–æ–≤–∞—Ä #3: –ù–æ—É—Ç–±—É–∫
–¢–æ–≤–∞—Ä #4: –ù–∞—É—à–Ω–∏–∫–∏ Sony
```

## üîç Root Cause Analysis

### –ü—Ä–∏—á–∏–Ω–∞ #1: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ iterationStack –≤ –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ú–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (Phase 2) –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –¥–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–æ–≤ (Phase 1) –∏ –Ω–µ –∑–Ω–∞–ª–∏ –æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–∏ `iterationStack` - –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è binding-–∑–Ω–∞—á–µ–Ω–∏–π –≤–Ω—É—Ç—Ä–∏ —Å–ø–∏—Å–∫–æ–≤.

**–ì–¥–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ:**
```jsx
// ‚ùå –ë–´–õ–û (–≤ ScreenComponents.jsx)
export const TextComponent = React.memo(({ component, context }) => {
  const props = component?.props ?? component?.properties ?? {};
  const content = resolveBindingValue(props?.content, context, '–¢–µ–∫—Å—Ç');
  //                                                             ^^^^^^
  //                                          –ù–µ—Ç iterationStack!
  ...
});
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ:**
1. –°–ø–∏—Å–æ–∫ —Å–æ–∑–¥–∞–≤–∞–ª `iterationStack = [{ alias: 'product', item: {...}, index: 0 }]`
2. `TextComponent` –ø–æ–ª—É—á–∞–ª `context` –∏ `component`, –Ω–æ –ù–ï –ø–æ–ª—É—á–∞–ª `iterationStack`
3. `resolveBindingValue('${product.name}', context, '–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞')` –≤—ã–∑—ã–≤–∞–ª—Å—è –ë–ï–ó iterationStack
4. –§—É–Ω–∫—Ü–∏—è –Ω–µ –º–æ–≥–ª–∞ –Ω–∞–π—Ç–∏ `product` –≤ –ø—É—Å—Ç–æ–º iterationStack –∏ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ fallback

### –ü—Ä–∏—á–∏–Ω–∞ #2: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏—Å—å iterationStack –≤ SandboxScreenRenderer

**–ü—Ä–æ–±–ª–µ–º–∞:**
–î–∞–∂–µ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, case-–±–ª–æ–∫–∏ –≤ `SandboxScreenRenderer.jsx` –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏ —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä.

**–ì–¥–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ:**
```jsx
// ‚ùå –ë–´–õ–û
case 'button': {
  return (
    <ButtonComponent
      component={component}
      context={context}
      // iterationStack –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è!
      onEvent={onEvent}
    />
  );
}
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –®–∞–≥ 1: –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (ScreenComponents.jsx)

–î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `iterationStack = []` –∏ –ø–µ—Ä–µ–¥–∞—á–∞ –≤ `resolveBindingValue`:

```jsx
// ‚úÖ –°–¢–ê–õ–û
export const TextComponent = React.memo(({ 
  component, 
  context, 
  iterationStack = []  // ‚Üê –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä
}) => {
  const props = component?.props ?? component?.properties ?? {};
  const content = resolveBindingValue(
    props?.content, 
    context, 
    '–¢–µ–∫—Å—Ç',
    { iterationStack }  // ‚Üê –ü–µ—Ä–µ–¥–∞—ë–º –≤ resolveBindingValue
  );
  ...
});
```

**–û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (memo):**
```jsx
}, (prevProps, nextProps) => 
  prevProps.component === nextProps.component && 
  prevProps.context === nextProps.context &&
  prevProps.iterationStack === nextProps.iterationStack  // ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞
);
```

### –®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ case-–±–ª–æ–∫–∏ (SandboxScreenRenderer.jsx)

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ `iterationStack` –≤–æ –≤—Å–µ –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

```jsx
// ‚úÖ –°–¢–ê–õ–û
case 'button': {
  return (
    <ButtonComponent
      component={component}
      context={context}
      iterationStack={iterationStack}  // ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞
      onEvent={onEvent}
    />
  );
}
```

### –®–∞–≥ 3: –£–¥–∞–ª–µ–Ω—ã debug –ª–æ–≥–∏

–£–¥–∞–ª–µ–Ω—ã –≤—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ `console.log('üîç ...)` –ª–æ–≥–∏, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.

## üìä –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### ScreenComponents.jsx (7 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–±–Ω–æ–≤–ª—ë–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä | –û–±–Ω–æ–≤–ª—ë–Ω memo | resolveBindingValue –≤—ã–∑–æ–≤–æ–≤ |
|-----------|-------------------|---------------|----------------------------|
| TextComponent | ‚úÖ | ‚úÖ | 1 |
| ButtonComponent | ‚úÖ | ‚úÖ | 5 |
| ImageComponent | ‚úÖ | ‚úÖ | 2 |
| InputComponent | ‚úÖ | ‚úÖ | 3 |
| ColumnComponent | ‚úÖ | ‚úÖ | 0 (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä) |
| RowComponent | ‚úÖ | ‚úÖ | 0 (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä) |
| ContainerComponent | ‚úÖ | ‚úÖ | 0 (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä) |

### SandboxScreenRenderer.jsx (7 case-–±–ª–æ–∫–æ–≤)

| Case-–±–ª–æ–∫ | –î–æ–±–∞–≤–ª–µ–Ω iterationStack |
|-----------|------------------------|
| case 'column' | ‚úÖ |
| case 'container' | ‚úÖ |
| case 'row' | ‚úÖ |
| case 'button' | ‚úÖ |
| case 'text' | ‚úÖ (—É–∂–µ –±—ã–ª) |
| case 'input' | ‚úÖ |
| case 'image' | ‚úÖ |

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
üîç [RAW ITEMS] Array length: 4
üîç [CHILD RENDER] index: 0, alias: "product"
TextComponent content: "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" (fallback!)
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
‚úÖ –¢–æ–≤–∞—Ä #1: –ö–ª–∞—Å—Å–Ω—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏
‚úÖ –¢–æ–≤–∞—Ä #2: –¢–µ–ª–µ—Ñ–æ–Ω Samsung  
‚úÖ –¢–æ–≤–∞—Ä #3: –ù–æ—É—Ç–±—É–∫
‚úÖ –¢–æ–≤–∞—Ä #4: –ù–∞—É—à–Ω–∏–∫–∏ Sony
```

## üìù –£—Ä–æ–∫–∏

1. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã –º–µ–∂–¥—É —Ñ–∞–∑–∞–º–∏**
   - Phase 2 (–º–µ–º–æ–∏–∑–∞—Ü–∏—è) —Å–æ–∑–¥–∞–Ω–∞ –î–û Phase 1 (—Å–ø–∏—Å–∫–∏)
   - –ù—É–∂–Ω–æ –±—ã–ª–æ –æ–±–Ω–æ–≤–∏—Ç—å Phase 2 –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è iterationStack –≤ Phase 1

2. **–ú–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –∑–Ω–∞—Ç—å –æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏**
   - React.memo —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç props, –ø–æ—ç—Ç–æ–º—É iterationStack –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Å–ø–∏—Å–∫–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
   - –ë–µ–∑ —ç—Ç–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ –æ–±–Ω–æ–≤—è—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∏—Ç–µ—Ä–∞—Ü–∏–∏

3. **Binding resolution —Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**
   - `resolveBindingValue` –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ `iterationStack` –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è `${product.xxx}`
   - –ë–µ–∑ iterationStack —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –∑–Ω–∞–µ—Ç, –≥–¥–µ –∏—Å–∫–∞—Ç—å `product`

## üéØ Checklist –¥–ª—è –±—É–¥—É—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

- [ ] –î–æ–±–∞–≤–∏—Ç—å `iterationStack = []` –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- [ ] –ü–µ—Ä–µ–¥–∞—Ç—å `{ iterationStack }` –≤–æ –≤—Å–µ –≤—ã–∑–æ–≤—ã `resolveBindingValue`
- [ ] –î–æ–±–∞–≤–∏—Ç—å `prevProps.iterationStack === nextProps.iterationStack` –≤ memo comparison
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π case-–±–ª–æ–∫ –≤ `SandboxScreenRenderer.jsx`
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–Ω—É—Ç—Ä–∏ —Å–ø–∏—Å–∫–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

## üì¶ –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `/src/pages/Sandbox/components/ScreenComponents.jsx` (360+ —Å—Ç—Ä–æ–∫)
- `/src/pages/Sandbox/SandboxScreenRenderer.jsx` (740+ —Å—Ç—Ä–æ–∫)
- `/docs/FINAL_OPTIMIZATION_REPORT.md` (–æ—Å–Ω–æ–≤–Ω–æ–π –æ—Ç—á—ë—Ç –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)
- `/docs/REACT_WINDOW_MIGRATION.md` (–º–∏–≥—Ä–∞—Ü–∏—è react-window)

## ‚ú® –°—Ç–∞—Ç—É—Å

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ
**–í–µ—Ä—Å–∏—è:** Dev server —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
**–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª "–ó–∞—Ä–∞–±–æ—Ç–∞–ª–æ!!"
