# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: selected_item_id –Ω–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ remove-item-integration

## –ü—Ä–æ–±–ª–µ–º–∞

–ü–∞—Ä–∞–º–µ—Ç—Ä `selected_item_id` –Ω–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è–ª—Å—è –≤ URL —Å–æ—Å—Ç–æ—è–Ω–∏—è `remove-item-integration`, –∏–∑-–∑–∞ —á–µ–≥–æ —É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ.

## –ü—Ä–∏—á–∏–Ω–∞

–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π endpoint API –±—ã–ª —É–∫–∞–∑–∞–Ω –≤ URL:

**–ë—ã–ª–æ (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û)**:
```json
{
  "url": "https://sandkittens.me/backservices/api/carts/3/advertisements/${selected_item_id}",
  "method": "delete"
}
```

**–°—Ç–∞–ª–æ (–ü–†–ê–í–ò–õ–¨–ù–û)**:
```json
{
  "url": "https://sandkittens.me/backservices/api/carts/3/items/${selected_item_id}",
  "method": "delete"
}
```

## –û–±—ä—è—Å–Ω–µ–Ω–∏–µ

–í API –∫–æ—Ä–∑–∏–Ω—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è —Å—Ö–µ–º–∞ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å —Ç–æ–≤–∞—Ä–∞–º–∏:

### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ endpoints:

| –û–ø–µ—Ä–∞—Ü–∏—è | Endpoint | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|-------|----------|
| –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã | `/api/carts/3/with-advertisements` | GET | –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã |
| –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ | `/api/carts/add-advertisement` | POST | –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä |
| –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ | `/api/carts/3/items/${id}` | PATCH | –ò–∑–º–µ–Ω–∏—Ç—å quantity |
| –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ | `/api/carts/3/items/${id}` | PATCH | –ò–∑–º–µ–Ω–∏—Ç—å selected |
| **–£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞** | **/api/carts/3/items/${id}** | **DELETE** | **–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä** ‚úÖ |

### –û—à–∏–±–æ—á–Ω–∞—è —Å—Ö–µ–º–∞ (–±—ã–ª–∞):

- ‚ùå `/api/carts/3/advertisements/${id}` - DELETE

–ü—Ä–æ–±–ª–µ–º–∞ –∑–∞–∫–ª—é—á–∞–ª–∞—Å—å –≤ —Ç–æ–º, —á—Ç–æ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –ø—É—Ç—å `/advertisements/`, –∞ –Ω–µ `/items/`, —Ö–æ—Ç—è:
1. –î–ª—è PATCH –æ–ø–µ—Ä–∞—Ü–∏–π (quantity, selected) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `/items/`
2. API –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–µ–Ω: –æ–¥–∏–Ω ID —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω–µ ‚Üí –æ–¥–∏–Ω –ø—É—Ç—å `/items/{id}`

## –†–µ—à–µ–Ω–∏–µ

–ò–∑–º–µ–Ω—ë–Ω URL –≤ `remove-item-integration`:

```diff
- "url": "https://sandkittens.me/backservices/api/carts/3/advertisements/${selected_item_id}",
+ "url": "https://sandkittens.me/backservices/api/carts/3/items/${selected_item_id}",
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
‚úÖ JSON –≤–∞–ª–∏–¥–Ω—ã–π!
URL –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è: https://sandkittens.me/backservices/api/carts/3/items/${selected_item_id}
```

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü–æ–ª–Ω—ã–π flow —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞:

1. **UI**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ –∫–Ω–æ–ø–∫—É üóëÔ∏è
   ```json
   {
     "event": "removeItem",
     "eventParams": {
       "selected_item_id": "${product.advertisement_id}"
     }
   }
   ```

2. **Edge**: –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å–æ–±—ã—Ç–∏—é `removeItem`
   ```json
   {
     "event": "removeItem",
     "target": "remove-item-integration"
   }
   ```

3. **State**: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ DELETE –∑–∞–ø—Ä–æ—Å–∞
   ```json
   {
     "url": "https://sandkittens.me/backservices/api/carts/3/items/${selected_item_id}",
     "method": "delete"
   }
   ```
   
   –ì–¥–µ `${selected_item_id}` = `product.advertisement_id` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `8`)
   
   –ò—Ç–æ–≥–æ–≤—ã–π URL: `DELETE /api/carts/3/items/8`

4. **Transition**: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
   ```json
   {
     "state_id": "fetch-cart-items"
   }
   ```

5. **Result**: –ö–æ—Ä–∑–∏–Ω–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –±–µ–∑ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞

## –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

‚úÖ `src/pages/Sandbox/data/avitoDemo.json` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω URL  
‚úÖ `docs/avitoDemo-state-graph.md` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è  
‚úÖ `docs/diagrams/avitoDemo-state-diagram.mmd` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–∞

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Sandbox —Å `avitoDemo`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–æ—Ä–∑–∏–Ω–µ –µ—Å—Ç—å —Ç–æ–≤–∞—Ä—ã
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É üóëÔ∏è –Ω–∞ –ª—é–±–æ–º —Ç–æ–≤–∞—Ä–µ
4. –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
   - ‚úÖ API –∑–∞–ø—Ä–æ—Å: `DELETE /api/carts/3/items/{id}`
   - ‚úÖ –ö–æ—Ä–∑–∏–Ω–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
   - ‚úÖ –¢–æ–≤–∞—Ä –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ —Å–ø–∏—Å–∫–∞
   - ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è

–ï—Å–ª–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –≤–∏–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ `/advertisements/` –≤–º–µ—Å—Ç–æ `/items/` - –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.

---

## –ò—Ç–æ–≥

–¢–µ–ø–µ—Ä—å —É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ API endpoint `/items/${id}`, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å —Ç–æ–≤–∞—Ä–∞–º–∏ –≤ –∫–æ—Ä–∑–∏–Ω–µ.
